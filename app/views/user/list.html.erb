<h1><%=getLongName('table_name','users')%>一覧</h1>

<%= paginate @users %>

<table class="list_table">
  <tr>
    <% if popup? %>
    <th>ログインID</th>
    <th>名前</th>
    <th style="width:100px">&nbsp;</th>
    <% else %>
    <th>ログインID</th>
    <th>名前</th>
    <th>Access level type</th>
    <th>Per page</th>
    <th>Sign in count</th>
    <th>Current sign in at</th>
    <th>Last sign in at</th>
    <th>Current sign in ip</th>
    <th>Last sign in ip</th>
    <th>Locked at</th>
    <th>Employee</th>
    <% end %>
  </tr>

  <% @users.each do |user| %>
  <tr>
    <% if popup? %>
    <td><%= link_to user.login, '#', :onClick => "setUserToParentWindow(#{user.id}, '#{user.nickname}');return false;" %></td>
    <td><%= user.nickname %></td>
    <td>&nbsp;</td>
    <% else %>
	  <td><%= back_to_link user.login, :action => :show , :id => user %></td>
    <td><%= user.nickname %></td>
    <td><%= user.access_level_type %></td>
    <td><%= user.per_page %></td>
    <td><%= user.sign_in_count %></td>
    <td><%= user.current_sign_in_at %></td>
    <td><%= user.last_sign_in_at %></td>
    <td><%= user.current_sign_in_ip %></td>
    <td><%= user.last_sign_in_ip %></td>
    <td><%= user.locked_at %></td>
    <td><%= link_to (user.employee ? 'Y' : ''), :controller => :account, :action => :show, :id => user %></td>
    <% end %>
  </tr>
  <% end %>
</table>

<%= paginate @users %>

<br />

<% unless popup? %>
<%= back_to_link (getLongName('table_name','users')+'の新規作成'), :action => :new %>
<% end %>

<% if popup? %>
<script type="text/javascript">
<!--
function setUserToParentWindow(id, nickname) {
  var user = new Object();
  user.pic_id = id;
  user.pic_name = nickname;
  window.opener.document.<%=params[:callback]%>("<%=params[:mode]%>", user);
  window.close();
}
// -->
</script>
<% end %>

